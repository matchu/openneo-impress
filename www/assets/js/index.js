$(function(){function k(a){$("#pet-preview").attr("src",a);d=true}function p(){$("#pet-preview").addClass("loading");$("#preview-response").text("")}function l(){$("#preview-response").text("Loading...");$("#pet-preview").addClass("loading").data("loadId",++f)}function g(a){$("#preview-response").text(a)}function m(){var a=$("#name").val();if(a){if(a!=n){l();k("http://pets.neopets.com/cpn/"+a+"/1/1.png")}}else p();n=a}var h=null,n,f=0,d=false,e=document.location.search.match(/\?name=(.+)/);if(e){e=
e[1];$("#name").val(e)}m();$("#name").keyup(function(){if(h){clearTimeout(h);d=false}h=setTimeout(m,250)});$("#pet-preview").load(function(){if(d&&$(this).data("loadId")==f){$(this).removeClass("loading");$("#preview-response").text("Is this what you wanted?")}}).error(function(){d&&$(this).data("loadId")==f&&g("Pet not found.")});var o=$("#species, #color");o.change(function(){var a={};o.each(function(){var c=$(this);a[c.attr("id")]=c.children(":selected").val()});l();$.ajax({url:"/pet_types.json",
data:{"for":"image",species_id:a.species,color_id:a.color},dataType:"json",success:function(c){c?k("http://pets.neopets.com/cp/"+c.image_hash+"/1/1.png"):g("We don't have data on that yet. If you own or know of a pet of that type, please type its name in above!")},error:function(){g("Error fetching preview. Try again?")}})});$.getJSON("http://blog.openneo.net/api/read/json?callback=?",function(a){a=a.posts[0];var c=$("#latest-blog-post"),q=a["url-with-slug"],i="The OpenNeo Blog",b="",j;if(a.type==
"regular"){i=a["regular-title"];b=a["regular-body"]}else if(a.type=="link"){i=a["link-text"];b=a["link-description"]}else if(a.type=="photo"){b=a["photo-caption"];j=a["photo-url-75"]}b=b.replace(/(<\/?[\S][^>]*>)/gi,"");if(b.length>100){b=b.substring(0,100);b=b.replace(/\s+\w+$/,"");b+="&hellip; <span>read more</span>"}c.html(b).attr("href",q);$("<h2/>",{text:i}).prependTo(c);j&&$("<img/>",{src:j}).prependTo(c);c.show()})});
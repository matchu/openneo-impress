$(function(){function h(a){$("#pet-preview").attr("src",a);c=true}function m(){$("#pet-preview").addClass("loading");$("#preview-response").text("")}function i(){$("#preview-response").text("Loading...");$("#pet-preview").addClass("loading").data("loadId",++e)}function f(a){$("#preview-response").text(a)}function j(){var a=$("#name").val();if(a){if(a!=k){i();h("http://pets.neopets.com/cpn/"+a+"/1/1.png")}}else m();k=a}var g=null,k,e=0,c=false,d=document.location.search.match(/\?name=(.+)/);if(d)d=
d[1];$("#name").val(d);j();$("#name").keyup(function(){if(g){clearTimeout(g);c=false}g=setTimeout(j,250)});$("#pet-preview").load(function(){if(c&&$(this).data("loadId")==e){$(this).removeClass("loading");$("#preview-response").text("Is this what you wanted?")}}).error(function(){c&&$(this).data("loadId")==e&&f("Pet not found.")});var l=$("#species, #color");l.change(function(){var a={};l.each(function(){var b=$(this);a[b.attr("id")]=b.children(":selected").val()});i();$.ajax({url:"/pet_types.json",
data:{"for":"image",species_id:a.species,color_id:a.color},dataType:"json",success:function(b){b?h("http://pets.neopets.com/cp/"+b.image_hash+"/1/1.png"):f("We don't have data on that yet. If you own or know of a pet of that type, please type its name in above!")},error:function(){f("Error fetching preview. Try again?")}})})});